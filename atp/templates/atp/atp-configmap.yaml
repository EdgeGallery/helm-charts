############################################################################
# Copyright 2020 Huawei Technologies Co., Ltd.
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#  http://www.apache.org/licenses/LICENSE-2.0
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
############################################################################


apiVersion: v1
kind: ConfigMap
metadata:
  name: atp-postgres-initdb-configmap
data:
  postgres.sql: |
    CREATE TABLE TASK_TABLE (
        ID                       VARCHAR(200)       NOT NULL,
        APPNAME                  VARCHAR(100)       NULL,
        APPVERSION               VARCHAR(100)       NULL,
        STATUS                   VARCHAR(100)       NULL,
        TESTCASEDETAIL           TEXT               NULL,
        CREATETIME               TIMESTAMP          NULL,
        ENDTIME                  TIMESTAMP          NULL,
        USERID                   VARCHAR(100)       NULL,
        USERNAME                 VARCHAR(100)       NULL,
        CONSTRAINT task_table_pkey PRIMARY KEY (ID)
    );

    CREATE TABLE TEST_CASE_TABLE (
        ID                       VARCHAR(200)       NOT NULL,
        NAME                     VARCHAR(100)       NULL,
        TYPE                     VARCHAR(100)       NULL,
        CLASSNAME                VARCHAR(100)       NULL,
        CONTENT                  TEXT               NULL, 
        DESCRIPTION              TEXT               NULL,
        CONSTRAINT test_case_table_pkey PRIMARY KEY (ID)
    );

    CREATE TABLE BATCH_TASK_MAPPING_TABLE (
        ID                       VARCHAR(200)       NOT NULL,
        SUBTASKID                TEXT               NULL,
        USERID                   VARCHAR(100)       NULL,
        USERNAME                 VARCHAR(100)       NULL,
        CONSTRAINT batch_task_mapping_table_pkey PRIMARY KEY (ID)
    );

    INSERT INTO public.test_case_table(
    	id, name, content,type, classname,  description)
    	VALUES ('4d203173-1111-4f62-aabb-8ebcec357f87','MFContent','','compliancesTest','org.edgegallery.atp.schedule.testcase.compliance.MFContentTestCase',''),
    ('4d203173-2222-4f62-aabb-8ebcec357f87','SourcePath','','compliancesTest','org.edgegallery.atp.schedule.testcase.compliance.SourcePathTestCase',''),
    ('4d203173-3333-4f62-aabb-8ebcec357f87','Suffix','','compliancesTest','org.edgegallery.atp.schedule.testcase.compliance.SuffixTestCase',''),
    ('4d203173-4444-4f62-aabb-8ebcec357f87','ToscaFile','','compliancesTest','org.edgegallery.atp.schedule.testcase.compliance.TOSCAFileTestCase',''),
    ('4d203173-5555-4f62-aabb-8ebcec357f87','Instantiate','','sandboxTest','org.edgegallery.atp.schedule.testcase.sandbox.InstantiateAppTestCase',''),
    ('4d203173-6666-4f62-aabb-8ebcec357f87','UnInstantiate','','sandboxTest','org.edgegallery.atp.schedule.testcase.sandbox.UninstantiateAppTestCase',''),
    ('4d203173-7777-4f62-aabb-8ebcec357f87','VirusScanning','','virusScanningTest','org.edgegallery.atp.schedule.testcase.virusScan.VirusScanTestCase','');
