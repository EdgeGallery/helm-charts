# pg secret
---
apiVersion: v1
kind: Secret
metadata:
  name: pg-secret
  namespace: mep
  labels:
    app: pg-secret
type: Opaque
data:
  pg_admin_pwd: YWRtaW4tUGFzczEyMw==
  kong_pg_pwd: a29uZy1QYXNzMTIz
  server.key: |-
    LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBcTgxWkNCdUJS
    VFYwSk9Vem5XZG5sNjJ5QkY3RXE1eU9JZnVCbE53NVc1TXNWL2g4CjMzV084WWJ3YTVtWlE4QVc4
    S0ZtOGZCa2J0RzVnNk5mTjZjK3VMUEs1Vlpidk8xOTNUS3g3Z1hGQlFMdnNvV1IKdkExUVN4UUUy
    bXJ3b1FJMitXcTdVZ0hMUmJrVVQ3SmpybEFKc3lJdFFIQlpodklqQzdybjJIVnVoRGRMOFF6Vwpu
    SVcyOGxUQWJZdWpqVDhmTElPNTRZMWxEZ3I2MGZDZWZvZXAyKzgvNFFYU1E1MzdYSGJ2d3paMkVV
    MldHZktJCjNuSWRiZE1uMlAxNVcwTHA3MTVmTzJBZ1NKMzRWWXlmVnh4c1UrRmZCeHFUb051OU1l
    d0JiWUhhTkZhYkw2Z1EKMWJGb2duM3JRK1N1dnhWcUg0Qy8zTFY5bXRWTlVlUmluMWVUendJREFR
    QUJBb0lCQUVzOFZpenl2cDJzVnZ5QgpVeVV2VDNKaElvQS9jQ2tuR2lkUG1PT3p2WHFZN09acGIy
    WDhlV2pVQ3gxVDJvYU03SDdjYjlTcnpZK3FVRytSCmIvVlRUR2hlZEJBU3pZSGpEeWQ3TitoZ3Bu
    TVhZaGp2M1c1WTlqeXF1NlZiQjUyNjlwQXJhWFQwVEN4d2JMQ3EKRW5VWG4rZk9vN3FBZVBSYnZY
    VTVtS1oyWnJ1SE5Bb1FpbllYb1p2cFFta0E4S1lYRzJxTlJreEt5WktIS0RaNQpoNDE1enlSM2RI
    OXhWRTlyV2VyTEwzVW1IaFFVUXplaFpwbmVsUXV2WUNqZllJRWNyZjIvaWNXM053a1dNMktVCklu
    eFhzNWJoN2pBdkw1MnZYQnZRNjlUbnJUVkhQbm9kWkpPekJWbkpKSkVsdUNTKzUybTBsNTM2MnJT
    aXUzRFAKVE1mUFBXRUNnWUVBMVJRM2dxVzdhRVgyZWwrSjZDYnl4dDQ3bm1Ed0h1RmI2b1VKTnlP
    STdSazNkWWF0ZVhyagpGaUJySmJFQmIrcXZtQnJWbmdyZFhiczJRb2dXQzJwS0RFc3JwU084UFht
    cVNhT0VkZVQrQjF3czNWSC8rc0dOCml5djRSWDdZS3orM3MwQzkvZGdSR1kvTzh2Tndpc3Qzd3lW
    ZzVjUlFnRHJRWGlpUkpsaHU3bFVDZ1lFQXptaWUKeFBrWFBCL0VBcjQ3dTJpRE5OeCtaMm9PSmJI
    TUhqTnB5MFJLY1pCUXZWYjVsWnhpTHpidkhtRHdCdUZwOFRCRwpFa3RoenVtZ2R4QjRtTW0yMU1W
    d0VHem52ZGVCQVNUSUFESXloS25mNjBPWVo1ZFpZZnZZZW1pVmVGSmgzRk5JCkl3bG5iUTNpZUZq
    c3kvclU0Zk1obHFOaEtucDdDRkhML3dYNDFaTUNnWUVBcHdWNDJhemxjTC9laTEvV0xxWlIKQ1Rk
    cnppSzROY3g2aXlNSzdUQ3FoUWVPSkU2VUxqUDRTd0RRWERRYUowcnpweXZwcEQ5cDg2M3F3MDMr
    MGFYWQpNemk5Rm00amdLQ2NyYXBDQzFPYkY5UFZ5d29hdDhqK0ZVZzdET1ozdGJiMVhNbno0MFY1
    YWVzQzBnZW1nUFVxCmhFb0pZVEYzMUh2Rmx2ai9oZW90MGgwQ2dZQmEzb3duUTFJTFVpREU1R0wv
    bW45STRsbHp4YWo4eDAySmJqRUIKSDh0Mk80YVFGSjVFVTFpV1dLVGt4dUJrNXcvdzhzT21nakZK
    R21sZWdZM1dGZGU3ekVBTnV5UTYyNGticThtdwo3R2g1SnlCQlByejF2aGZIbjB3cWQ2aDJGQzZw
    QkxFWlc2YUF5RUFQbzNaOFJxMDUzQVBKZ1p2aFM1S21rdnd3CkJiMEtxUUtCZ0JjM2h0bkh2dXha
    YkU0OHk4b2Q3cEpKRzRVZCtKU3V2M0JYcWRHWjRhVGFubzdHZzBoUHhuVE0KSERKaFk2VFJOa1pF
    RHExMTY5eHVUVXQ0Ly9mT2JVS3JZQXVVd2ZEUG1tMXlKZU9zcmtjSjVER0I4MmlTSXg1UQpleHNh
    c1NvUktBWVJVRWQ5Q0c5SGJ5UnRLNmVNQWo2eFZ6U0NMeFdHQVdPcXJGTGZOVVpXCi0tLS0tRU5E
    IFJTQSBQUklWQVRFIEtFWS0tLS0tCg==

  server.crt: |-
    LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURWakNDQWo2Z0F3SUJBZ0lKQU5kbWQ5NEF3
    clhqTUEwR0NTcUdTSWIzRFFFQkN3VUFNRnd4Q3pBSkJnTlYKQkFZVEFrTk9NUTh3RFFZRFZRUUlE
    QVpRWld0cGJtY3hFREFPQmdOVkJBY01CMEpsYVdwcGJtY3hGREFTQmdOVgpCQW9NQzJWa1oyVm5Z
    V3hzWlhKNU1SUXdFZ1lEVlFRRERBdGxaR2RsWjJGc2JHVnllVEFlRncweU1EQTVNREl3Ck1qVTRN
    elphRncweU1ERXdNREl3TWpVNE16WmFNRjB4Q3pBSkJnTlZCQVlUQWtOT01SQXdEZ1lEVlFRSURB
    ZEMKWldscWFXNW5NUkF3RGdZRFZRUUhEQWRDWldscWFXNW5NUlF3RWdZRFZRUUtEQXRsWkdkbFoy
    RnNiR1Z5ZVRFVQpNQklHQTFVRUF3d0xaV1JuWldkaGJHeGxjbmt3Z2dFaU1BMEdDU3FHU0liM0RR
    RUJBUVVBQTRJQkR3QXdnZ0VLCkFvSUJBUUNyelZrSUc0RkZOWFFrNVRPZFoyZVhyYklFWHNTcm5J
    NGgrNEdVM0RsYmt5eFgrSHpmZFk3eGh2QnIKbVpsRHdCYndvV2J4OEdSdTBibURvMTgzcHo2NHM4
    cmxWbHU4N1gzZE1ySHVCY1VGQXUreWhaRzhEVkJMRkFUYQphdkNoQWpiNWFydFNBY3RGdVJSUHNt
    T3VVQW16SWkxQWNGbUc4aU1MdXVmWWRXNkVOMHZ4RE5hY2hiYnlWTUJ0Cmk2T05QeDhzZzduaGpX
    VU9DdnJSOEo1K2g2bmI3ei9oQmRKRG5mdGNkdS9ETm5ZUlRaWVo4b2plY2gxdDB5ZlkKL1hsYlF1
    bnZYbDg3WUNCSW5maFZqSjlYSEd4VDRWOEhHcE9nMjcweDdBRnRnZG8wVnBzdnFCRFZzV2lDZmV0
    RAo1SzYvRldvZmdML2N0WDJhMVUxUjVHS2ZWNVBQQWdNQkFBR2pHakFZTUFrR0ExVWRFd1FDTUFB
    d0N3WURWUjBQCkJBUURBZ1hnTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFDUHh1ZHE5NUwxSmY4
    NWsrWm1CZTh6SUZpRmdkQjcKaklzSGJOYVNlQjBwSy9RRzJ3QUFIbFhHdjVySDZYRE1IZlhDZzFN
    WXViZU1qWGlIUkNobVpScldUakxPeHdSNgo2QmxJbjFIay81Q2ErZGZVRWNXY1NoRUxlVHUzM1V0
    VDN4NFJkWUIvMldzTE5RVWo2ZnVTN3hwNmtxQjVRMHZYCjZpRUhMR1h6Vm5kVnJReC8vZ2wzWkpr
    WDhZMm1UQ1F6Uk90L041WVlWVWtkNXlWL05hTnlTakI5emdrY2R4eDUKWU5VTk9kQy9KUTQzN2l1
    MUVTdHlmNjZyclZPYmUveU4xMlFsaXZJNG5iM3l5bzZ6dzZrNUk3ZGdvTnBONFVCdApaRlNPME9t
    elEzdTl4SlBQaTl4SUlSMzhoVlh2S09JNHBaYyt0dmNSdUN0WW4rR0NkTHRsUGZLTQotLS0tLUVO
    RCBDRVJUSUZJQ0FURS0tLS0tCg==

# pg init secret
---
apiVersion: v1
kind: Secret
metadata:
  name: pg-init-sql
  namespace: mep
  labels:
    app: pg-init-sql
type: Opaque
data:
  init.sql: |-
    Q1JFQVRFIFVTRVIga29uZyBXSVRIIFBBU1NXT1JEICdrb25nLVBhc3MxMjMnOwpSRVZPS0UgY29u
    bmVjdCBPTiBEQVRBQkFTRSBrb25nIEZST00gUFVCTElDOwpHUkFOVCBBTEwgUFJJVklMRUdFUyBP
    TiBEQVRBQkFTRSBrb25nIFRPIGFkbWluOwpHUkFOVCBBTEwgUFJJVklMRUdFUyBPTiBEQVRBQkFT
    RSBrb25nIFRPIGtvbmc7CkdSQU5UIGNvbm5lY3QgT04gREFUQUJBU0Uga29uZyBUTyBrb25nOwpB
    TFRFUiBEQVRBQkFTRSB0ZW1wbGF0ZTAgaXNfdGVtcGxhdGUgZmFsc2U7CkFMVEVSIERBVEFCQVNF
    IHRlbXBsYXRlMSBpc190ZW1wbGF0ZSBmYWxzZTsKRFJPUCBEQVRBQkFTRSB0ZW1wbGF0ZTA7CkRS
    T1AgREFUQUJBU0UgdGVtcGxhdGUxOwpEUk9QIERBVEFCQVNFIHBvc3RncmVzOwo=

# mep ssl secret
---
apiVersion: v1
kind: Secret
metadata:
  name: mep-ssl
  namespace: mep
  labels:
    app: mep-ssl
type: Opaque
data:
  cert_pwd: dGU5Rm12JXFhcQo=
  server.cer: |-
    LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURWakNDQWo2Z0F3SUJBZ0lKQU5kbWQ5NEF3
    clhqTUEwR0NTcUdTSWIzRFFFQkN3VUFNRnd4Q3pBSkJnTlYKQkFZVEFrTk9NUTh3RFFZRFZRUUlE
    QVpRWld0cGJtY3hFREFPQmdOVkJBY01CMEpsYVdwcGJtY3hGREFTQmdOVgpCQW9NQzJWa1oyVm5Z
    V3hzWlhKNU1SUXdFZ1lEVlFRRERBdGxaR2RsWjJGc2JHVnllVEFlRncweU1EQTVNREl3Ck1qVTRN
    elphRncweU1ERXdNREl3TWpVNE16WmFNRjB4Q3pBSkJnTlZCQVlUQWtOT01SQXdEZ1lEVlFRSURB
    ZEMKWldscWFXNW5NUkF3RGdZRFZRUUhEQWRDWldscWFXNW5NUlF3RWdZRFZRUUtEQXRsWkdkbFoy
    RnNiR1Z5ZVRFVQpNQklHQTFVRUF3d0xaV1JuWldkaGJHeGxjbmt3Z2dFaU1BMEdDU3FHU0liM0RR
    RUJBUVVBQTRJQkR3QXdnZ0VLCkFvSUJBUUNyelZrSUc0RkZOWFFrNVRPZFoyZVhyYklFWHNTcm5J
    NGgrNEdVM0RsYmt5eFgrSHpmZFk3eGh2QnIKbVpsRHdCYndvV2J4OEdSdTBibURvMTgzcHo2NHM4
    cmxWbHU4N1gzZE1ySHVCY1VGQXUreWhaRzhEVkJMRkFUYQphdkNoQWpiNWFydFNBY3RGdVJSUHNt
    T3VVQW16SWkxQWNGbUc4aU1MdXVmWWRXNkVOMHZ4RE5hY2hiYnlWTUJ0Cmk2T05QeDhzZzduaGpX
    VU9DdnJSOEo1K2g2bmI3ei9oQmRKRG5mdGNkdS9ETm5ZUlRaWVo4b2plY2gxdDB5ZlkKL1hsYlF1
    bnZYbDg3WUNCSW5maFZqSjlYSEd4VDRWOEhHcE9nMjcweDdBRnRnZG8wVnBzdnFCRFZzV2lDZmV0
    RAo1SzYvRldvZmdML2N0WDJhMVUxUjVHS2ZWNVBQQWdNQkFBR2pHakFZTUFrR0ExVWRFd1FDTUFB
    d0N3WURWUjBQCkJBUURBZ1hnTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFDUHh1ZHE5NUwxSmY4
    NWsrWm1CZTh6SUZpRmdkQjcKaklzSGJOYVNlQjBwSy9RRzJ3QUFIbFhHdjVySDZYRE1IZlhDZzFN
    WXViZU1qWGlIUkNobVpScldUakxPeHdSNgo2QmxJbjFIay81Q2ErZGZVRWNXY1NoRUxlVHUzM1V0
    VDN4NFJkWUIvMldzTE5RVWo2ZnVTN3hwNmtxQjVRMHZYCjZpRUhMR1h6Vm5kVnJReC8vZ2wzWkpr
    WDhZMm1UQ1F6Uk90L041WVlWVWtkNXlWL05hTnlTakI5emdrY2R4eDUKWU5VTk9kQy9KUTQzN2l1
    MUVTdHlmNjZyclZPYmUveU4xMlFsaXZJNG5iM3l5bzZ6dzZrNUk3ZGdvTnBONFVCdApaRlNPME9t
    elEzdTl4SlBQaTl4SUlSMzhoVlh2S09JNHBaYyt0dmNSdUN0WW4rR0NkTHRsUGZLTQotLS0tLUVO
    RCBDRVJUSUZJQ0FURS0tLS0tCg==
  server_key.pem: |-
    LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpQcm9jLVR5cGU6IDQsRU5DUllQVEVECkRF
    Sy1JbmZvOiBBRVMtMjU2LUNCQyw2MTY1NEEzREJCNzRDNTZDNzkyQzNGODUxNkM0NzY5RgoKRWZK
    dEphaHlhSEVaWUNST3o5RXZZVFlTSVhiZVhaRWNZc0Y5UktPN1JjRXM1NW14bWNoMWZBVW81NTMw
    TmVnMgo5WUxHY2tlR0oxSnJTVldkVm44ZEd2L3FTWVQyaVNyaHhkQWNrcm1WaUVvNEVLdit2d0pn
    SFFSdWNVKzZtdzFkCnNpT3hmMFpCYW5VWmdSMHBsUWFyaTJlVXp4NTh4WmE4OTVzRkFNc2JNR2Rx
    aUM2dDROSW5BZnhWQ1k2M3N5VlIKd3UwVFA5a3UzUFZNdXRlUW05L0ZVRzZqTUNhYm1nMk5weVU2
    S1dNaVhXR3ZXODdFTFRMQ3RCcldya0NMSUQydAp1YllyQmp4UE1zUGRpeDhodkJSamE3SDF0SWc3
    VkpuMmlkaHJTR2xNZHJCdmthRG15U3FIZUUwQWZlUjUzelNWClhrRTVzYVNEeHozV2ZyMDc4VkZD
    b2d0T0ZIdEZBRWNoTkEra2dCMVlZM001TTJNcXhxZnM1Yk15WmdwUThzdW8KRmJRcEJtK3BOMTJw
    NVNmSmZvSTdnMlVGeVQvaUdVbHhrdHA0cG5vUnpUSGhaa2lvbi82WGhoeVpoVFBQbTEwbQpqMXNN
    bHhoajdZYzhlLzl3OWZmL2RxMXRidDIzTjl4NVM2bSttRkhFdis5bkhTa2FYeDNxQ2pia25tYm5x
    cHBCCmVxaitqM2RHQTBOQnNFRGg2RXBUTnNTamt0LzhrTEw4UHNLaWZQRjcwU1hKemNuaVZGd0VF
    NmpxQkdkNEE0aTcKRmRpd2R3THJNSzluRlRXWXJEOE00RU11YzF3ZEZhQ0IrY0FqNFZoVlM1OE94
    OTNIVTYzR2FjWDBKa2JVcEpKNwp1TXR1MmU1VmtxNFlZK0NRdjBMMXlUaGJPcmZLOEtIOTk4NVBX
    VXVyL1hqRlFPbDdYOXZNcWlWeU9qeFNnQ1RSCkJseFpLdG4zWE5NbGNvcktVenhhQkFoa0ZzMGV1
    ajY3OHl3TjFWQkE5VjZnOVdQSE5FZ3F6TTlUZUNKTUhaREcKZUxUZHJXMVpTazVuSXFMTFpNWkRG
    MFpwSFM1bGtuR2ErTG5aeFJGTTVBaTBxaDd6UnNObnNMSCsrTW43TGZ6TAppSklLbWQwN3UvVGFL
    OUFWQzRUcTZVcWFGcE54K2NmWXE2cktKUHlhbUVIMFNVMmdZemNxb3pjUkgyNjdXWU1LCjc0dk41
    VDRwTzk5R0VyUXJDOFh1OXFqVlRkOUZxd1p6WWY2VEFQL2FIN0M0djFaTVlJQk8yamFoRXl4dHU5
    d1oKVWdBMGxteTJpdGUxTHJjL3hERVlmZUVEV1dwZlNXcE9wc2VycHRlN0d5OW8xNm03NXJ0MEUr
    ajVlQk5OdkxSOQplYTFhN011T2VsRGxtb3FHNTNaUnk3TlFFSWlZRTA3cVoyd0gyL01FdEk2TjdK
    VjJmUXl1TXNPUTRxbXN1OSt6CkxCZ3NZV05UY3BZdXBZdnJVcjJEaWlCaUJxT0p6bkN1WlRTdUdY
    dUx0RCszRkxscm9TQ0VqL1E1MGNpTTM4elcKUUFKSkFQT2lxVUJ6TENid1ZjdTRjUFRRcTJ6Nm5k
    dUYxK3lXRjNlLysvQUlMd1NqTHhKQWRXTzRSQzZWQmZlbQoxdGUzcUxKUjMzeDkxQWs3M2N3Nmtl
    Ry9GU0htQzAwQmhVZzhHSFhWYWtHbW4yN2x0SXFpbytCelkxYTFuWDRiCmJ1QVF6b2ZGY3hmeGt2
    dktVUElsZGhKTVRxODFVUll1eHNqT2xTa1g1UVZpVCtYS1gwU2QvV2dncUpDd2tYWXAKYjFqMHhq
    aGNsaXdFLy81ZmRIWi9oY2lGUThSQjZ5OEM3dXR4OXpkZS83Z0c5MXh1bHRWWjFxa05OSnl0TXZG
    cApqeHlPTGFsWUwwM1BpWkRob0lhNkNyRHpYaXBNbXV0VU1IcktxeTF1blh0cHVzVjZnT0dxbFd5
    eTRjVzIrRmJ2CnF0YnM3d2JHbWtUUGZZV0k3MGJKbkFxblZaeWRXdzVCT2pPRDE0cFM1YWY2aDNG
    UW5kcnMySEo5RkE5YWJGTEQKME52UDM1MXhkTXo2SE5DQzNLcUJ3ZnhQaS80UlF3MXdrR3pYZ1N5
    VGlWZkxJbXJWbWk4VzBPYnM4dDM3Ny9LVQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
  trust.cer: |-
    LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURpekNDQW5PZ0F3SUJBZ0lKQU1MdTNJYk0y
    MVVETUEwR0NTcUdTSWIzRFFFQkN3VUFNRnd4Q3pBSkJnTlYKQkFZVEFrTk9NUTh3RFFZRFZRUUlE
    QVpRWld0cGJtY3hFREFPQmdOVkJBY01CMEpsYVdwcGJtY3hGREFTQmdOVgpCQW9NQzJWa1oyVm5Z
    V3hzWlhKNU1SUXdFZ1lEVlFRRERBdGxaR2RsWjJGc2JHVnllVEFlRncweU1EQTVNREl3Ck1qVTRN
    elphRncweU1UQTVNREl3TWpVNE16WmFNRnd4Q3pBSkJnTlZCQVlUQWtOT01ROHdEUVlEVlFRSURB
    WlEKWld0cGJtY3hFREFPQmdOVkJBY01CMEpsYVdwcGJtY3hGREFTQmdOVkJBb01DMlZrWjJWbllX
    eHNaWEo1TVJRdwpFZ1lEVlFRRERBdGxaR2RsWjJGc2JHVnllVENDQVNJd0RRWUpLb1pJaHZjTkFR
    RUJCUUFEZ2dFUEFEQ0NBUW9DCmdnRUJBSy9FTmNkeXhobksrVkVGL0ZVRzZSV2pMLzdJUk5aRWV0
    cWZYRjFoUjZTVHp1MEF6b1VUUTdTWmRMWUEKV2d1dnpnVFhqNmxUY29STis3L1dJUVNLN3o0c3ha
    NlpyUFV0cDAxRDJKRy9RaURuRnhMQmpobjNBUzhVV0JEbAp4ZXY5ZWVRR0lvQllPRTRBcEVkMktX
    bXNYT2NqUkIwODBmU0V6WXdRdWZoNjBsaUMwaExpMSsyU2J6S1UyS0hVCms0eStyUHlhRjFJZmFS
    K01LNVE5cmVxWS9sQXNubTFLR3NKMDdPMkVyS1ZLQkMwbFZmSmFMZUtpWW9aYmY3bkMKNEl0QUd6
    Wkxub0x4WDQvMEl4bXYxWXQ4d0RTVkdGMmVCMGRVY0tucmM3STUzYkRWN0N6cjdqeSt6TkEwZE9V
    TgpxTEdsRENrVjFxeWpoQkVoM2w0L1hFb2sycmtDQXdFQUFhTlFNRTR3SFFZRFZSME9CQllFRkp1
    dHgyNXI2SVBMCkFTcjBmbksvcGo4UWVXM3BNQjhHQTFVZEl3UVlNQmFBRkp1dHgyNXI2SVBMQVNy
    MGZuSy9wajhRZVczcE1Bd0cKQTFVZEV3UUZNQU1CQWY4d0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dF
    QkFHL3ZOdExQQzRWcWNQR3ViVUgrRkVOSApJcCtNVzM2dWZOWlNpVzhBZ0REdlV1R3J2Qmg3bGxH
    aTFFTGhJUkhBUWx1VCthRWRFUVFMVlNUSGhCUG5mbkNGCjFXRDF2M01taHB6VjVLaXRCTDdScXJN
    eHdHYmlBckVtWWpyVGVCTWIzdTYxYTJnYWhMUWFnZlJJbG5UWnVDU3gKVDN5MloyUDdhSVFtKzRN
    TGxkclhaZ0pFNmRlNExONUw5TFBnSHRDdkVaMWFNdFd6T2JmUlVmWlZHcys3RDdINwpVUFdyR0lp
    bmF0cVM4WHBtMnJ1Q2ZqaC9ObU0yaTB0bXhGcUgzY1lGempwVXN6cEZjNjI3RW53ZVcrbkYyWGVF
    CmFRLzFsd0ZYOXcyK0lwRytMajBzRlRZZFAxRkJDTkVXT2ZjdmFtU001bjM2MDFVUGpJSE4zdWZR
    OUZDWFk2ST0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=

# mepauth secret
---
apiVersion: v1
kind: Secret
metadata:
  name: mepauth-secret
  namespace: mep
  labels:
    app: mepauth-secret
type: Opaque
data:
  server.crt: |-
    LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURWakNDQWo2Z0F3SUJBZ0lKQU5kbWQ5NEF3
    clhqTUEwR0NTcUdTSWIzRFFFQkN3VUFNRnd4Q3pBSkJnTlYKQkFZVEFrTk9NUTh3RFFZRFZRUUlE
    QVpRWld0cGJtY3hFREFPQmdOVkJBY01CMEpsYVdwcGJtY3hGREFTQmdOVgpCQW9NQzJWa1oyVm5Z
    V3hzWlhKNU1SUXdFZ1lEVlFRRERBdGxaR2RsWjJGc2JHVnllVEFlRncweU1EQTVNREl3Ck1qVTRN
    elphRncweU1ERXdNREl3TWpVNE16WmFNRjB4Q3pBSkJnTlZCQVlUQWtOT01SQXdEZ1lEVlFRSURB
    ZEMKWldscWFXNW5NUkF3RGdZRFZRUUhEQWRDWldscWFXNW5NUlF3RWdZRFZRUUtEQXRsWkdkbFoy
    RnNiR1Z5ZVRFVQpNQklHQTFVRUF3d0xaV1JuWldkaGJHeGxjbmt3Z2dFaU1BMEdDU3FHU0liM0RR
    RUJBUVVBQTRJQkR3QXdnZ0VLCkFvSUJBUUNyelZrSUc0RkZOWFFrNVRPZFoyZVhyYklFWHNTcm5J
    NGgrNEdVM0RsYmt5eFgrSHpmZFk3eGh2QnIKbVpsRHdCYndvV2J4OEdSdTBibURvMTgzcHo2NHM4
    cmxWbHU4N1gzZE1ySHVCY1VGQXUreWhaRzhEVkJMRkFUYQphdkNoQWpiNWFydFNBY3RGdVJSUHNt
    T3VVQW16SWkxQWNGbUc4aU1MdXVmWWRXNkVOMHZ4RE5hY2hiYnlWTUJ0Cmk2T05QeDhzZzduaGpX
    VU9DdnJSOEo1K2g2bmI3ei9oQmRKRG5mdGNkdS9ETm5ZUlRaWVo4b2plY2gxdDB5ZlkKL1hsYlF1
    bnZYbDg3WUNCSW5maFZqSjlYSEd4VDRWOEhHcE9nMjcweDdBRnRnZG8wVnBzdnFCRFZzV2lDZmV0
    RAo1SzYvRldvZmdML2N0WDJhMVUxUjVHS2ZWNVBQQWdNQkFBR2pHakFZTUFrR0ExVWRFd1FDTUFB
    d0N3WURWUjBQCkJBUURBZ1hnTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFDUHh1ZHE5NUwxSmY4
    NWsrWm1CZTh6SUZpRmdkQjcKaklzSGJOYVNlQjBwSy9RRzJ3QUFIbFhHdjVySDZYRE1IZlhDZzFN
    WXViZU1qWGlIUkNobVpScldUakxPeHdSNgo2QmxJbjFIay81Q2ErZGZVRWNXY1NoRUxlVHUzM1V0
    VDN4NFJkWUIvMldzTE5RVWo2ZnVTN3hwNmtxQjVRMHZYCjZpRUhMR1h6Vm5kVnJReC8vZ2wzWkpr
    WDhZMm1UQ1F6Uk90L041WVlWVWtkNXlWL05hTnlTakI5emdrY2R4eDUKWU5VTk9kQy9KUTQzN2l1
    MUVTdHlmNjZyclZPYmUveU4xMlFsaXZJNG5iM3l5bzZ6dzZrNUk3ZGdvTnBONFVCdApaRlNPME9t
    elEzdTl4SlBQaTl4SUlSMzhoVlh2S09JNHBaYyt0dmNSdUN0WW4rR0NkTHRsUGZLTQotLS0tLUVO
    RCBDRVJUSUZJQ0FURS0tLS0tCg==
  server.key: |-
    LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBcTgxWkNCdUJS
    VFYwSk9Vem5XZG5sNjJ5QkY3RXE1eU9JZnVCbE53NVc1TXNWL2g4CjMzV084WWJ3YTVtWlE4QVc4
    S0ZtOGZCa2J0RzVnNk5mTjZjK3VMUEs1Vlpidk8xOTNUS3g3Z1hGQlFMdnNvV1IKdkExUVN4UUUy
    bXJ3b1FJMitXcTdVZ0hMUmJrVVQ3SmpybEFKc3lJdFFIQlpodklqQzdybjJIVnVoRGRMOFF6Vwpu
    SVcyOGxUQWJZdWpqVDhmTElPNTRZMWxEZ3I2MGZDZWZvZXAyKzgvNFFYU1E1MzdYSGJ2d3paMkVV
    MldHZktJCjNuSWRiZE1uMlAxNVcwTHA3MTVmTzJBZ1NKMzRWWXlmVnh4c1UrRmZCeHFUb051OU1l
    d0JiWUhhTkZhYkw2Z1EKMWJGb2duM3JRK1N1dnhWcUg0Qy8zTFY5bXRWTlVlUmluMWVUendJREFR
    QUJBb0lCQUVzOFZpenl2cDJzVnZ5QgpVeVV2VDNKaElvQS9jQ2tuR2lkUG1PT3p2WHFZN09acGIy
    WDhlV2pVQ3gxVDJvYU03SDdjYjlTcnpZK3FVRytSCmIvVlRUR2hlZEJBU3pZSGpEeWQ3TitoZ3Bu
    TVhZaGp2M1c1WTlqeXF1NlZiQjUyNjlwQXJhWFQwVEN4d2JMQ3EKRW5VWG4rZk9vN3FBZVBSYnZY
    VTVtS1oyWnJ1SE5Bb1FpbllYb1p2cFFta0E4S1lYRzJxTlJreEt5WktIS0RaNQpoNDE1enlSM2RI
    OXhWRTlyV2VyTEwzVW1IaFFVUXplaFpwbmVsUXV2WUNqZllJRWNyZjIvaWNXM053a1dNMktVCklu
    eFhzNWJoN2pBdkw1MnZYQnZRNjlUbnJUVkhQbm9kWkpPekJWbkpKSkVsdUNTKzUybTBsNTM2MnJT
    aXUzRFAKVE1mUFBXRUNnWUVBMVJRM2dxVzdhRVgyZWwrSjZDYnl4dDQ3bm1Ed0h1RmI2b1VKTnlP
    STdSazNkWWF0ZVhyagpGaUJySmJFQmIrcXZtQnJWbmdyZFhiczJRb2dXQzJwS0RFc3JwU084UFht
    cVNhT0VkZVQrQjF3czNWSC8rc0dOCml5djRSWDdZS3orM3MwQzkvZGdSR1kvTzh2Tndpc3Qzd3lW
    ZzVjUlFnRHJRWGlpUkpsaHU3bFVDZ1lFQXptaWUKeFBrWFBCL0VBcjQ3dTJpRE5OeCtaMm9PSmJI
    TUhqTnB5MFJLY1pCUXZWYjVsWnhpTHpidkhtRHdCdUZwOFRCRwpFa3RoenVtZ2R4QjRtTW0yMU1W
    d0VHem52ZGVCQVNUSUFESXloS25mNjBPWVo1ZFpZZnZZZW1pVmVGSmgzRk5JCkl3bG5iUTNpZUZq
    c3kvclU0Zk1obHFOaEtucDdDRkhML3dYNDFaTUNnWUVBcHdWNDJhemxjTC9laTEvV0xxWlIKQ1Rk
    cnppSzROY3g2aXlNSzdUQ3FoUWVPSkU2VUxqUDRTd0RRWERRYUowcnpweXZwcEQ5cDg2M3F3MDMr
    MGFYWQpNemk5Rm00amdLQ2NyYXBDQzFPYkY5UFZ5d29hdDhqK0ZVZzdET1ozdGJiMVhNbno0MFY1
    YWVzQzBnZW1nUFVxCmhFb0pZVEYzMUh2Rmx2ai9oZW90MGgwQ2dZQmEzb3duUTFJTFVpREU1R0wv
    bW45STRsbHp4YWo4eDAySmJqRUIKSDh0Mk80YVFGSjVFVTFpV1dLVGt4dUJrNXcvdzhzT21nakZK
    R21sZWdZM1dGZGU3ekVBTnV5UTYyNGticThtdwo3R2g1SnlCQlByejF2aGZIbjB3cWQ2aDJGQzZw
    QkxFWlc2YUF5RUFQbzNaOFJxMDUzQVBKZ1p2aFM1S21rdnd3CkJiMEtxUUtCZ0JjM2h0bkh2dXha
    YkU0OHk4b2Q3cEpKRzRVZCtKU3V2M0JYcWRHWjRhVGFubzdHZzBoUHhuVE0KSERKaFk2VFJOa1pF
    RHExMTY5eHVUVXQ0Ly9mT2JVS3JZQXVVd2ZEUG1tMXlKZU9zcmtjSjVER0I4MmlTSXg1UQpleHNh
    c1NvUktBWVJVRWQ5Q0c5SGJ5UnRLNmVNQWo2eFZ6U0NMeFdHQVdPcXJGTGZOVVpXCi0tLS0tRU5E
    IFJTQSBQUklWQVRFIEtFWS0tLS0tCg==
  ca.crt: |-
    LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURpekNDQW5PZ0F3SUJBZ0lKQU1MdTNJYk0y
    MVVETUEwR0NTcUdTSWIzRFFFQkN3VUFNRnd4Q3pBSkJnTlYKQkFZVEFrTk9NUTh3RFFZRFZRUUlE
    QVpRWld0cGJtY3hFREFPQmdOVkJBY01CMEpsYVdwcGJtY3hGREFTQmdOVgpCQW9NQzJWa1oyVm5Z
    V3hzWlhKNU1SUXdFZ1lEVlFRRERBdGxaR2RsWjJGc2JHVnllVEFlRncweU1EQTVNREl3Ck1qVTRN
    elphRncweU1UQTVNREl3TWpVNE16WmFNRnd4Q3pBSkJnTlZCQVlUQWtOT01ROHdEUVlEVlFRSURB
    WlEKWld0cGJtY3hFREFPQmdOVkJBY01CMEpsYVdwcGJtY3hGREFTQmdOVkJBb01DMlZrWjJWbllX
    eHNaWEo1TVJRdwpFZ1lEVlFRRERBdGxaR2RsWjJGc2JHVnllVENDQVNJd0RRWUpLb1pJaHZjTkFR
    RUJCUUFEZ2dFUEFEQ0NBUW9DCmdnRUJBSy9FTmNkeXhobksrVkVGL0ZVRzZSV2pMLzdJUk5aRWV0
    cWZYRjFoUjZTVHp1MEF6b1VUUTdTWmRMWUEKV2d1dnpnVFhqNmxUY29STis3L1dJUVNLN3o0c3ha
    NlpyUFV0cDAxRDJKRy9RaURuRnhMQmpobjNBUzhVV0JEbAp4ZXY5ZWVRR0lvQllPRTRBcEVkMktX
    bXNYT2NqUkIwODBmU0V6WXdRdWZoNjBsaUMwaExpMSsyU2J6S1UyS0hVCms0eStyUHlhRjFJZmFS
    K01LNVE5cmVxWS9sQXNubTFLR3NKMDdPMkVyS1ZLQkMwbFZmSmFMZUtpWW9aYmY3bkMKNEl0QUd6
    Wkxub0x4WDQvMEl4bXYxWXQ4d0RTVkdGMmVCMGRVY0tucmM3STUzYkRWN0N6cjdqeSt6TkEwZE9V
    TgpxTEdsRENrVjFxeWpoQkVoM2w0L1hFb2sycmtDQXdFQUFhTlFNRTR3SFFZRFZSME9CQllFRkp1
    dHgyNXI2SVBMCkFTcjBmbksvcGo4UWVXM3BNQjhHQTFVZEl3UVlNQmFBRkp1dHgyNXI2SVBMQVNy
    MGZuSy9wajhRZVczcE1Bd0cKQTFVZEV3UUZNQU1CQWY4d0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dF
    QkFHL3ZOdExQQzRWcWNQR3ViVUgrRkVOSApJcCtNVzM2dWZOWlNpVzhBZ0REdlV1R3J2Qmg3bGxH
    aTFFTGhJUkhBUWx1VCthRWRFUVFMVlNUSGhCUG5mbkNGCjFXRDF2M01taHB6VjVLaXRCTDdScXJN
    eHdHYmlBckVtWWpyVGVCTWIzdTYxYTJnYWhMUWFnZlJJbG5UWnVDU3gKVDN5MloyUDdhSVFtKzRN
    TGxkclhaZ0pFNmRlNExONUw5TFBnSHRDdkVaMWFNdFd6T2JmUlVmWlZHcys3RDdINwpVUFdyR0lp
    bmF0cVM4WHBtMnJ1Q2ZqaC9ObU0yaTB0bXhGcUgzY1lGempwVXN6cEZjNjI3RW53ZVcrbkYyWGVF
    CmFRLzFsd0ZYOXcyK0lwRytMajBzRlRZZFAxRkJDTkVXT2ZjdmFtU001bjM2MDFVUGpJSE4zdWZR
    OUZDWFk2ST0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  jwt_publickey: |-
    LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FR
    OEFNSUlCQ2dLQ0FRRUFyOHV2bEVRNTEvQXJyeEVKUSt6UQpRT3JLb21xZnVYVFl1elludDN5bStu
    SndxNGlSTEY4ZmpSQlIvOFFkaVdQQlE0ZFp3a0ZtQ0ZUdStHNXZVSS9VCmpzTkpjVE5hSFBXZFlv
    WG1rYk4zdkwzdlBSdzBydzZjZ3JYei9pVHAyWnYzQ0s4WUx0TUVjdUZ1ckhHOHB3QlYKNG95alYr
    OFhWM1Izanp4a1FpVTNIR2hiSG9mcENsZzNrdVY5MzBkS1lOVURIblR2OTkvWmdxL1hOYmxNSHF0
    Swo4RUJzNUxMYW4wc1pBeHUxeTlzS0lSZTRZemx2bmFhMzlpeG83eGkzTHVmVDZDb0U5M3Zndnps
    ZnZyZXpCSVZzCnhFK2l4dFkzcE9zR2dZMWRTU004WWszMEQrY201czlNcnFYNlNRK3RGK0xaa1hT
    b0hGWFhyY0pEUm84cVpDOWkKZndJREFRQUIKLS0tLS1FTkQgUFVCTElDIEtFWS0tLS0tCg==
  jwt_encrypted_privatekey: |-
    LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpQcm9jLVR5cGU6IDQsRU5DUllQVEVECkRF
    Sy1JbmZvOiBBRVMtMjU2LUNCQyw2M0Y0MkRCMTNGNDY3MDQ0NTYzM0NFQjgzNjE4MDRBQwoKeDNW
    VU1iOGFXZERUU2owVldVa0lBV0hSdTExeG9qRFFYYnY3c1dSOFhTaGl3WCtLRTZJSUdmK1FnZE5Q
    M3A2VworNFBkSUdicy8ybmV5TUdaQTNBQ3BJNEVmbFo4R01qQzJZeXdYRFd4WnBCcFFuRThWNzZJ
    aHNtUEd2eUtiTVBwCm1vSWF5YjNDbVpHZzE2TUNPNS9BME92Si9UN21vSklRcjcwSTNxa1Z0RXgy
    VWVad1lQLzgySkZ2NWxIQmI1c2sKeHpXN3BueCtkNVRhSFowejF5anZlNjNEZ2ZHNUN5cDVVY0Y5
    OUk3dlZ1azVockRnWGVvdjRBbnE1L1A4NEx4UwpnTXFoSEorbVIyeExTVVhLWjVROVZhOXR1eFBX
    WXJuWk9Dbk9UNkE5bnkxcEMxUUhMcTFKMWxLdjRaODdRREhrCjZWV083dHRWcUZkUm5XQkNtMnhw
    eEM0ZVdmNlVHUzRVYy80QjAxNSs4TjZrN3FTQmZEVmJXTmEvQW9iUW1DeHcKVXphMmNVcEhueFI2
    RGx3c0RGZUswQzlSSHNQSVJWMFFsUE0vN1hGMEZDc0xyY29CNE13dHFhRlBFMk9aOXJQRApkUFk2
    cUQyM0pXbk50SUZKNkFBMUw4QU5Bb3pjOTJvU09VK1YxRXpUeThiSVB1ZFBhVm5VYU9rcnZJeWJt
    QWJkCkI4eVN1Nktva2VPeHRoY2ZLNUZZYVc1ckhyclFYNHQ4NVJaNzcvSzRxTkN2dHhBejh6TTYv
    VkxSandyMkJubEUKbFkyMWlackEwMXR6RnpoS1l5MTJlWDFtbjhBT1dzaHBYWS9EN1c5UktQMUY3
    MDRFUy9CbldmOGE3TW13STRDSwpmbHpZdHdwbk9IaUE5QXVpdVV1K1ErbnFGQlJVaFhKRnJwejZv
    cVZLNUhTZ3pLZFkxdEZGYnNMSzB1MGRqUHFRClhUYVhqTmg5V0tzajVlV0ViM1o0UHV0YktjK1lU
    OGZZbmErTnM1Ull2YzltcTB1djZweUJ5ajZaTEV1dFNldzkKQ0kyUHJLM0R1N0o3NkxyaTVlak4y
    Yi9ISytHbzJ6NCtQRGoxeWtHdEdQemhpVXh6YkdrWDJZK0FSS2ZZcVY1WQoxSVh4Qk5WMmhrRlVY
    Mitqd01KbFlzdnVtM3hKT0VhN2xqU2F4U3A1Zmc3SGV0QVBpM2xDdHB6VEVXWnN3K2o4Cm1RQTMv
    cUoyNWF2VWErSWM1YW9mNTBPSi9FUWc0K1NBeGRZaXIzOG9kUXF5SjcvaktqenU0NUdEQS9HNGhh
    SFkKeTNCR05CcDdqVVVORkhDWGVyYW5yUGgwOW1FdGc5dWgvYzhYQXExSll4ci9mK1MyTTgwVnFp
    KzJCWE5sZ1VuNwpxZldkOWdCbytnVXBxWlFqQWxWS1M2TlQvTkV3ekFsZnYrSEJxMzloQ1VWSHhK
    RzRwRUpQVnV4QXRyUDRySzNBCjF3S21yaXBGU28zajRFZlBGQkhQSjhoRDFPSFRHeXY1cjZMMWtW
    U0NRUVVTN2ljaXhSR29GY3FyTG1RcUY0TmoKdGVTRnlFbzBLMjh6dURUMHBtMkNkdHdsL3BqNk41
    VE4rcGw3dkdia0pPQWo1dCtVQVFUdVp5VDFUNXdaZWJrcApYZ1N3WHhtdStWbk9razFZMzlWQnE4
    SzRTaFJNM3VvS0Mza253ZkpLT09kU05MMmVSaW5CTzY0NnVqcE9FZEhlCmY3MDNaUUdORHNTOTJZ
    eEIwVmFSVVlBZ0lFNmF2dExTa004dmJ5MUFucVgxTmJLZVZxd21PNUVQMjQzSlJxSWoKZ0drOWsx
    aEEzb1JVb0dqeUI0cVZQREJ6eHQvbEdzbURKdEtmOTN1ZjZUcGs2VUc4YWVxT09kUW9kejNBbDhK
    YgpPa3EzUGliMFdvWlpCSzVteTNHcGMwN2wvLzkwUVlnMWt0cDl2YXNTVkNNZzRNVGFHWjhHZXQr
    UG5uM0p6OE9PCnlLbmlrSTFpVUpBa21DWjlxTGN1MXlxaUl4RnhaYWdFU0tXRDB0aExJMVQrcjFQ
    YTFMMUVGVll6OEdFbWtjMy8KbkdNK1Vhd1BkY0FndWFTN05xcldJMmI2TDVEeDhkZFczY1ZYOXpM
    dlJQNC9aNlM4Rks2YjA3c0NkS1hjTHBpSAotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=

  
# kong secret
---
apiVersion: v1
kind: Secret
metadata:
  name: kong-secret
  namespace: mep
  labels:
    app: kong-secret
type: Opaque
stringData:
  kong.conf: |-
    plugins = bundled, appid-header
    lua_ssl_trusted_certificate = /var/lib/kong/data/ca.crt
    ssl_cert = /var/lib/kong/data/kong.crt
    ssl_cert_key = /var/lib/kong/data/kong.key
    admin_ssl_cert = /var/lib/kong/data/kong.crt
    admin_ssl_cert_key = /var/lib/kong/data/kong.key
    # kong_prefix = /var/lib/kong/data/kongdata
    ssl_cipher_suite = custom
    ssl_ciphers = ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384
    nginx_http_ssl_protocols = tlsv1.2 tlsv1.3
    nginx_http_ssl_prefer_server_ciphers = on
  handler.lua: |-
    -- Copyright 2020 Huawei Technologies Co., Ltd.
    --
    -- Licensed under the Apache License, Version 2.0 (the "License");
    -- you may not use this file except in compliance with the License.
    -- You may obtain a copy of the License at
    --
    --     http://www.apache.org/licenses/LICENSE-2.0
    --
    -- Unless required by applicable law or agreed to in writing, software
    -- distributed under the License is distributed on an "AS IS" BASIS,
    -- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    -- See the License for the specific language governing permissions and
    -- limitations under the License.
    
    local BasePlugin = require "kong.plugins.base_plugin"
    local jwt_decoder = require "kong.plugins.jwt.jwt_parser"
    
    
    local kong = kong
    local type = type
    local re_gmatch = ngx.re.gmatch
    
    local AddAppIdHeaderHandler = {}
    
    
    AddAppIdHeaderHandler.VERSION  = "1.0.0"
    AddAppIdHeaderHandler.PRIORITY = 10
    
    
    local function retrieve_token()
      local request_headers = kong.request.get_headers()
      local token_header = request_headers["authorization"]
      if token_header then
        if type(token_header) == "table" then
          token_header = token_header[1]
        end
        local iterator, iter_err = re_gmatch(token_header, "\\s*[Bb]earer\\s+(.+)")
        if not iterator then
          kong.log.err(iter_err)
        end
    
        local m, err = iterator()
        if err then
          kong.log.err(err)
        end
    
        if m and #m >0 then
          return m
        end
      end
    end
    
    
    local function add_app_id_check_ip()
      local token, err = retrieve_token()
      if err then
        kong.log.err(err)
        return kong.response.exit(500, { message = "Unexpected error." })
      end
    
      local jwt, err = jwt_decoder:new(token[1])
      token[1] = nil
      unpack(token)
      if err then
        kong.log.err(err)
        return kong.response.exit(500, { message = "Unexpected error."})
      end
    
      local claims = jwt.claims
    
      local app_id = claims["sub"]
    
      -- check client ip same
      local remote_addr = ngx.var.remote_addr
    
      local client_ip = claims["clientip"]
    
      if client_ip == "UNKNOWN_IP" or remote_addr ~= client_ip then
        return false
      end
    
      local set_header = kong.service.request.set_header
      local clear_header = kong.service.request.clear_header
      clear_header("X-AppinstanceID")
      set_header("X-AppinstanceID", app_id)
      return true
    end
    
    
    function AddAppIdHeaderHandler:access(conf)
      local ok, err = add_app_id_check_ip()
      if err then
        kong.log.err(err)
        return kong.response.exit(500, { message = "Unexpected error."})
      end
      if not ok then
        return kong.response.exit(401, { message = "Unauthorized" })
      end
    end
    
    return AddAppIdHeaderHandler
  schema.lua: |-
    local typedefs = require "kong.db.schema.typedefs"
    
    
    local schema = {
      name = "appid-header",
      fields = {
        { protocols = typedefs.protocols_http },
        { config = {
            -- The 'config' record is the custom part of the plugin schema
            type = "record",
            fields = {
            },
          },
        },
      },
    }
    
    return schema

